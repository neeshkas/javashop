<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–µ–º–æ - –ú—É–∑—ã–∫–∞–ª—å–Ω—ã–π –ú–∞–≥–∞–∑–∏–Ω "–ü–µ—Ä–µ–º–µ–Ω"</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <!-- Header -->
    <header class="site-header">
        <div class="container">
            <h1>üé∏ –ú–£–ó–´–ö–ê–õ–¨–ù–´–ô –ú–ê–ì–ê–ó–ò–ù "–ü–ï–†–ï–ú–ï–ù" üé∏</h1>
            <nav class="site-nav">
                <a href="index.html">–ö–ê–¢–ê–õ–û–ì</a>
                <a href="cart.html">–ö–û–†–ó–ò–ù–ê</a>
                <a href="admin.html">–ê–î–ú–ò–ù</a>
                <a href="demo.html" class="active">–î–ï–ú–û</a>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container" style="margin-top: 60px; margin-bottom: 60px;">
        <h2 style="text-align: center; margin-bottom: 40px;">SOUND CHECK - –î–µ–º–æ –ê–∫—Ü–∏–π</h2>

        <!-- Promotion Demo -->
        <div class="torn-edge">
            <h3 style="color: var(--cigarette-yellow); margin-bottom: 20px;">–ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–ê–Ø –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ü–†–û–ú–û-–ê–ö–¶–ò–ô</h3>
            <div class="divider"></div>

            <div style="margin-top: 30px;">
                <!-- Product Selection -->
                <div class="mb-3">
                    <label style="display: block; margin-bottom: 10px; color: var(--white); font-weight: bold;">
                        –í—ã–±–µ—Ä–∏ —Ç–æ–≤–∞—Ä:
                    </label>
                    <select id="demo-product" class="select-typewriter">
                        <option value="25000">–ì–∏—Ç–∞—Ä–∞ "–ê–∫–∫–æ—Ä–¥" (‚ÇΩ25,000)</option>
                        <option value="2500">–í–∏–Ω–∏–ª "–ì—Ä—É–ø–ø–∞ –ö—Ä–æ–≤–∏" (‚ÇΩ2,500)</option>
                        <option value="150000">–°–∏–Ω—Ç–µ–∑–∞—Ç–æ—Ä Yamaha DX7 (‚ÇΩ150,000)</option>
                        <option value="1200">–§—É—Ç–±–æ–ª–∫–∞ "–ü–µ—Ä–µ–º–µ–Ω!" (‚ÇΩ1,200)</option>
                    </select>
                </div>

                <!-- Quantity -->
                <div class="mb-3">
                    <label style="display: block; margin-bottom: 10px; color: var(--white); font-weight: bold;">
                        –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: <span id="qty-display">1</span>
                    </label>
                    <input
                      type="range"
                      id="demo-quantity"
                      min="1"
                      max="10"
                      value="1"
                      style="width: 100%; height: 8px; background: var(--concrete); cursor: pointer;"
                    >
                </div>

                <!-- Promotion Selection -->
                <div class="mb-4">
                    <label style="display: block; margin-bottom: 10px; color: var(--white); font-weight: bold;">
                        –ü–æ–ø—Ä–æ–±—É–π –∞–∫—Ü–∏–∏:
                    </label>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-top: 15px;">
                        <button class="btn-stamp" onclick="applyPromo('none')">–ë–ï–ó –°–ö–ò–î–ö–ò</button>
                        <button class="btn-stamp" onclick="applyPromo('percentage-15')">–°–ö–ò–î–ö–ê 15%</button>
                        <button class="btn-stamp" onclick="applyPromo('fixed-5000')">–°–ö–ò–î–ö–ê 5000‚ÇΩ</button>
                        <button class="btn-stamp" onclick="applyPromo('bogo-half')">2-–ô –ü–û –ü–û–õ–¶–ï–ù–´</button>
                        <button class="btn-stamp" onclick="applyPromo('buy3-pay2')">3 –ü–û –¶–ï–ù–ï 2</button>
                    </div>
                </div>

                <div class="divider"></div>

                <!-- Result -->
                <div style="background: var(--black); padding: 30px; border: 3px solid var(--soviet-red); margin-top: 30px;">
                    <h4 style="color: var(--cigarette-yellow); margin-bottom: 20px;">–†–ï–ó–£–õ–¨–¢–ê–¢:</h4>

                    <div style="font-family: var(--font-main); font-size: 1.1rem; line-height: 2;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>–ë–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞:</span>
                            <span id="result-base-price">‚ÇΩ0</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; color: var(--soviet-red);">
                            <span>–°–∫–∏–¥–∫–∞ (<span id="result-promo-name">-</span>):</span>
                            <span id="result-discount">-‚ÇΩ0</span>
                        </div>

                        <div class="divider" style="margin: 20px 0;"></div>

                        <div style="display: flex; justify-content: space-between; font-size: 1.5rem; font-weight: bold; color: var(--soviet-red);">
                            <span>–ò–¢–û–ì–û:</span>
                            <span id="result-final-price">‚ÇΩ0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="divider" style="margin: 60px 0;"></div>

        <!-- Tax Demo -->
        <div class="torn-edge">
            <h3 style="color: var(--cigarette-yellow); margin-bottom: 20px;">–î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ù–ê–õ–û–ì–û–í</h3>
            <div class="divider"></div>

            <div style="margin-top: 30px;">
                <div class="mb-3">
                    <label style="display: block; margin-bottom: 10px; color: var(--white); font-weight: bold;">
                        –°—É–º–º–∞ (subtotal): <span id="tax-subtotal-display">‚ÇΩ10,000</span>
                    </label>
                    <input
                      type="range"
                      id="tax-subtotal"
                      min="1000"
                      max="100000"
                      step="1000"
                      value="10000"
                      style="width: 100%; height: 8px; background: var(--concrete); cursor: pointer;"
                    >
                </div>

                <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-top: 20px;">
                    <button class="btn-stamp" onclick="applyTax('no-tax')">–ë–ï–ó –ù–ê–õ–û–ì–ê</button>
                    <button class="btn-stamp" onclick="applyTax('flat-vat-12')">–ù–î–° 12%</button>
                    <button class="btn-stamp" onclick="applyTax('flat-vat-5')">–ù–î–° 5%</button>
                    <button class="btn-stamp" onclick="applyTax('progressive')">–ü–†–û–ì–†–ï–°–°–ò–í–ù–´–ô</button>
                </div>

                <div style="background: var(--black); padding: 30px; border: 3px solid var(--soviet-red); margin-top: 30px;">
                    <h4 style="color: var(--cigarette-yellow); margin-bottom: 20px;">–†–ï–ó–£–õ–¨–¢–ê–¢:</h4>
                    <div style="font-size: 1.2rem; line-height: 2;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>–°—É–º–º–∞ –¥–æ –Ω–∞–ª–æ–≥–∞:</span>
                            <span id="tax-result-subtotal">‚ÇΩ0</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; color: var(--soviet-red);">
                            <span>–ù–∞–ª–æ–≥ (<span id="tax-result-name">-</span>):</span>
                            <span id="tax-result-amount">+‚ÇΩ0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="container">
            <p class="graffiti" style="font-size: 1.5rem; margin-bottom: 15px;">–¶–û–ô –ñ–ò–í</p>
            <p>&copy; 2025 –ú—É–∑—ã–∫–∞–ª—å–Ω—ã–π –ú–∞–≥–∞–∑–∏–Ω "–ü–µ—Ä–µ–º–µ–Ω". –í –ø–∞–º—è—Ç—å –æ –í–∏–∫—Ç–æ—Ä–µ –¶–æ–µ –∏ –≥—Ä—É–ø–ø–µ "–ö–∏–Ω–æ".</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="js/api.js"></script>
    <script>
      // Demo Logic

      let promotions = [];
      let taxes = [];

      // Init
      document.addEventListener('DOMContentLoaded', async () => {
        promotions = await ShopAPI.getPromotions();
        taxes = await ShopAPI.getTaxPolicies();

        // Event listeners
        document.getElementById('demo-product').addEventListener('change', calculate);
        document.getElementById('demo-quantity').addEventListener('input', (e) => {
          document.getElementById('qty-display').textContent = e.target.value;
          calculate();
        });

        document.getElementById('tax-subtotal').addEventListener('input', (e) => {
          const value = parseInt(e.target.value);
          document.getElementById('tax-subtotal-display').textContent = `‚ÇΩ${value.toLocaleString()}`;
          calculateTaxDemo();
        });

        calculate();
        calculateTaxDemo();
      });

      // Promotion Demo
      let currentPromoId = 'none';

      function applyPromo(promoId) {
        currentPromoId = promoId;
        calculate();
      }

      function calculate() {
        const basePrice = parseInt(document.getElementById('demo-product').value);
        const qty = parseInt(document.getElementById('demo-quantity').value);
        const promo = promotions.find(p => p.id === currentPromoId);

        const totalBase = basePrice * qty;
        const totalWithPromo = ShopAPI.calculatePriceWithPromotion(basePrice, qty, promo);
        const discount = totalBase - totalWithPromo;

        document.getElementById('result-base-price').textContent = `‚ÇΩ${totalBase.toLocaleString()}`;
        document.getElementById('result-promo-name').textContent = promo ? promo.name : '-';
        document.getElementById('result-discount').textContent = `-‚ÇΩ${discount.toLocaleString()}`;
        document.getElementById('result-final-price').textContent = `‚ÇΩ${totalWithPromo.toLocaleString()}`;
      }

      // Tax Demo
      let currentTaxId = 'no-tax';

      function applyTax(taxId) {
        currentTaxId = taxId;
        calculateTaxDemo();
      }

      function calculateTaxDemo() {
        const subtotal = parseInt(document.getElementById('tax-subtotal').value);
        const taxPolicy = taxes.find(t => t.id === currentTaxId);

        const taxAmount = ShopAPI.calculateTax(subtotal, taxPolicy, false);

        document.getElementById('tax-result-subtotal').textContent = `‚ÇΩ${subtotal.toLocaleString()}`;
        document.getElementById('tax-result-name').textContent = taxPolicy ? taxPolicy.name : '-';
        document.getElementById('tax-result-amount').textContent = `+‚ÇΩ${taxAmount.toLocaleString()}`;
      }
    </script>
</body>
</html>
